/**
 * dialog  v2.1.0
 * @date  2018-04-12
 * @author  方雨_Yu
 * @home  https://github.com/sufangyu/dialog2
 * @bugs  https://github.com/sufangyu/dialog2/issues
 * Licensed under MIT
 */

!function(a,b,c,d){"use strict";var e=function(){function d(b,c){this.$element=a(b),this.settings=a.extend({},a.fn.dialog.defaults,c)}return d.prototype={_init:function(){var b=this;if(console.log("初始化弹窗"),clearTimeout(b.autoCloseTimer),b.isHided=!1,b.tapBug=b._hasTapBug(),b.platform=f.platform,b.dislogStyle="default"===b.settings.style?b.platform:b.settings.style,0===a("#dialog-body-no-scroll").length){a("head").append('<style id="dialog-body-no-scroll">.body-no-scroll { position: absolute; overflow: hidden; width: 100%; }</style>')}b._renderDOM(),b._bindEvents()},_renderDOM:function(){var a=this;a.settings.onBeforeShow(),a._createDialogDOM(a.settings.type),a.settings.onShow()},_bindEvents:function(){var d=this;d.$confirmBtn.on(f.tapEvent,function(a){var b=d.settings.onClickConfirmBtn();(b||void 0===b)&&d.closeDialog()}).on("touchend",function(a){a.preventDefault()}),d.$cancelBtn.on(f.tapEvent,function(a){var b=d.settings.onClickCancelBtn();(b||void 0===b)&&d.closeDialog()}).on("touchend",function(a){a.preventDefault()}),d.$closeBtn.on(f.tapEvent,function(a){var b=d.settings.onClickCloseBtn();(b||void 0===b)&&d.closeDialog()}).on("touchend",function(a){a.preventDefault()}),d.settings.overlayClose&&a(c).on(f.tapEvent,".dialog-overlay",function(a){d.closeDialog()}),d.settings.autoClose>0&&(console.log(d.settings.autoClose/1e3+"秒后, 自动关闭弹窗"),d._autoClose()),a(c).on("webkitAnimationEnd MSAnimationEnd animationend",".dialog-content",function(){d.isHided&&(d.removeDialog(),d.tapBug&&d._removeTapOverlayer())}),d.settings.buttons.length&&a.each(d.settings.buttons,function(a,b){d.$dialogContentFt.children("button").eq(a).on(f.tapEvent,function(a){a.preventDefault();var c=b.callback();(c||void 0===c)&&d.closeDialog()})}),a(b).on("onorientationchange"in b?"orientationchange":"resize",function(){d.settings.contentScroll&&setTimeout(function(){d._resetDialog()},200)}),a(c).on("touchmove",function(b){return!d.$dialog.find(a(b.target)).length}),d.settings.contentScroll&&d._contentScrollEvent(),"android"===d.dislogStyle&&a(".dialog-content-ft > .dialog-btn").ripple()},_createDialogDOM:function(b){var c=this;switch(c.$dialog=a('<div class="dialog dialog-open '+c.settings.dialogClass+'" data-style="'+c.dislogStyle+'"></div>'),c.$dialogOverlay=a('<div class="dialog-overlay"></div>'),c.$dialogContent=a('<div class="dialog-content"></div>'),c.$dialogTitle=a('<div class="dialog-content-hd"><h3 class="dialog-content-title">'+c.settings.titleText+"</h3></div>"),c.$dialogContentFt=a('<div class="dialog-content-ft"></div>'),c.$dialogContentBd=a('<div class="dialog-content-bd"></div>'),c.$closeBtn=a('<div class="dialog-btn-close"><span>close</span></div>'),c.$confirmBtn=a('<button class="dialog-btn dialog-btn-confirm '+c.settings.buttonClassConfirm+'">'+c.settings.buttonTextConfirm+"</button>"),c.$cancelBtn=a('<button class="dialog-btn dialog-btn-cancel '+c.settings.buttonClassCancel+'">'+c.settings.buttonTextCancel+"</button>"),b){case"alert":c.$dialog.addClass("dialog-modal"),c.settings.overlayShow&&c.$dialog.append(c.$dialogOverlay),c.settings.titleShow&&c.$dialogContent.append(c.$dialogTitle),c.settings.closeBtnShow&&c.$dialogTitle.append(c.$closeBtn),c.$dialogContentBd.html(c.settings.content),c.$dialogContentFt.append(c.$confirmBtn),c.$dialogContent.append(c.$dialogContentBd).append(c.$dialogContentFt),c.$dialog.append(c.$dialogContent),a("body").append(c.$dialog),c.settings.bodyNoScroll&&a("body").addClass("body-no-scroll"),c.settings.contentScroll&&c._setDialogContentHeight();break;case"confirm":if(c.$dialog.addClass("dialog-modal"),c.settings.overlayShow&&c.$dialog.append(c.$dialogOverlay),c.settings.titleShow&&c.$dialogContent.append(c.$dialogTitle),c.settings.closeBtnShow&&c.$dialogTitle.append(c.$closeBtn),c.settings.buttons.length){var d="";a.each(c.settings.buttons,function(a,b){d+='<button class="dialog-btn '+b.class+'">'+b.name+"</button>"}),c.$dialogContentFt.append(d).addClass(c.settings.buttonStyle)}else c.$dialogContentFt.append(c.$cancelBtn).append(c.$confirmBtn).addClass(c.settings.buttonStyle);c.$dialogContentBd.html(c.settings.content),c.$dialogContent.append(c.$dialogContentBd).append(c.$dialogContentFt),c.$dialog.append(c.$dialogContent),a("body").append(c.$dialog),c.settings.contentScroll&&c._setDialogContentHeight(),c.settings.bodyNoScroll&&a("body").addClass("body-no-scroll");break;case"toast":c.$dialog.addClass("dialog-toast"),c.settings.overlayShow&&c.$dialog.append(c.$dialogOverlay);var e=a(c.settings.content);""!==c.settings.infoIcon&&""!==c.settings.infoText?e=a('<img class="info-icon" src="'+c.settings.infoIcon+'" /><span class="info-text">'+c.settings.infoText+"</span>"):""===c.settings.infoIcon&&""!==c.settings.infoText?e=a('<span class="info-text">'+c.settings.infoText+"</span>"):""!==c.settings.infoIcon&&""===c.settings.infoText&&(e=a('<img class="info-icon" src="'+c.settings.infoIcon+'" />')),c.$dialogContentBd.append(e),c.$dialogContent.append(c.$dialogContentBd),c.$dialog.append(c.$dialogContent),a("body").append(c.$dialog),c.settings.bodyNoScroll&&a("body").addClass("body-no-scroll");break;case"notice":c.$dialog.addClass("dialog-notice"),"bottom"===c.settings.position&&c.$dialog.addClass("dialog-notice-bottom"),c.settings.overlayShow&&c.$dialog.append(c.$dialogOverlay);var f=a(c.settings.content);""!==c.settings.infoIcon&&""!==c.settings.infoText?f=a('<img class="info-icon" src="'+c.settings.infoIcon+'" /><span class="info-text">'+c.settings.infoText+"</span>"):""===c.settings.infoIcon&&""!==c.settings.infoText?f=a('<span class="info-text">'+c.settings.infoText+"</span>"):""!==c.settings.infoIcon&&""===c.settings.infoText&&(f=a('<img class="info-icon" src="'+c.settings.infoIcon+'" />')),c.$dialogContentBd.append(f),c.$dialogContent.append(c.$dialogContentBd),c.$dialog.append(c.$dialogContent),a("body").append(c.$dialog),c.settings.bodyNoScroll&&a("body").addClass("body-no-scroll");break;default:console.log("running default")}},_setDialogContentHeight:function(){var a=this;setTimeout(function(){var b=a.$dialogContentBd.height(),c=a._getDialogContentMaxHeight();a.$dialogContentBd.css({"max-height":c}).addClass("content-scroll"),b>c?a.$dialogContentFt.addClass("dialog-content-ft-border"):a.$dialogContentFt.removeClass("dialog-content-ft-border")},80)},_getDialogContentMaxHeight:function(){var c=this,d=a(b).height(),e=c.$dialogTitle.height(),f=c.$dialogContentFt.height(),g=d-e-f-60;return g=g%2==0?g:g-1},_resetDialog:function(){this._setDialogContentHeight()},_contentScrollEvent:function(){var b=!1,d={x:0,y:0,top:0,left:0};a(c).on("touchstart mousedown",".content-scroll",function(c){var e=c.changedTouches?c.changedTouches[0]:c;return b=!0,d.x=e.clientX,d.y=e.clientY,d.top=a(this).scrollTop(),d.left=a(this).scrollLeft(),!1}).on("touchmove mousemove",".content-scroll",function(c){var e=c.changedTouches?c.changedTouches[0]:c;if(!b)return!1;var f=d.top-(e.clientY-d.y),g=d.left-(e.clientX-d.x);a(this).scrollTop(f).scrollLeft(g)}).on("touchend mouseup",".content-scroll",function(a){a.preventDefault(),b=!1})},_autoClose:function(){var a=this;a.autoCloseTimer=setTimeout(function(){a.closeDialog()},a.settings.autoClose)},closeDialog:function(){var a=this;a.isHided=!0,a.settings.onBeforeClosed(),a.$dialog.addClass("dialog-close").removeClass("dialog-open"),a.tapBug&&a._appendTapOverlayer()},removeDialog:function(){var b=this;b.$dialog.remove(),b.isHided=!1,b.settings.onClosed(),b.settings=a.fn.dialog.defaults,b.settings.bodyNoScroll&&a("body").removeClass("body-no-scroll")},update:function(b){var c=this;clearTimeout(c.autoCloseTimer),c.settings=a.extend({},a.fn.dialog.defaults,b),""!==c.settings.content&&c.$dialogContentBd.html(c.settings.content);var d=c.$dialogContentBd.find(".info-icon"),e=c.$dialogContentBd.find(".info-text");d.attr({src:c.settings.infoIcon}),e.html(c.settings.infoText),c._bindEvents()},_hasTapBug:function(){return f.isAndroid&&f.version<4.4},_appendTapOverlayer:function(){var b=this;b.$tapBugOverlayer=a(".solve-tap-bug"),b.$tapBugOverlayer.length||(b.$tapBugOverlayer=a('<div class="solve-tap-bug" style="margin:0;padding:0;border:0;background:rgba(0,0,0,0);-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%;height:100%;position:fixed;top:0;left:0;"></div>'),a("body").append(b.$tapBugOverlayer))},_removeTapOverlayer:function(){var a=this;setTimeout(function(){a.$tapBugOverlayer.remove()},350)}},d}(),f=function(a){var b=a.navigator.userAgent,d=/android|adr/gi.test(b),e=/iphone|ipod|ipad/gi.test(b)&&!d,f=d||e,g=e?"ios":d?"android":"default",h="ontouchend"in c,i=e?/os [\d._]*/gi:/android [\d._]*/gi,j=b.match(i),k=(j+"").replace(/[^0-9|_.]/gi,"").replace(/_/gi,".");return{isIOS:e,isAndroid:d,isMobile:f,platform:g,version:parseFloat(k),isSupportTouch:h,tapEvent:f&&h?"tapEvent":"click"}}(b);a.fn.dialog=function(c){var d=this;return this.each(function(){var f=a(this),g=b.jQuery?f.data("dialog"):a.fn.dialog.lookup[f.data("dialog")];if(g){var h=new e(this,c);h._init()}else{var h=new e(this,c);h._init(),b.jQuery?f.data("dialog",h):(a.fn.dialog.lookup[++a.fn.dialog.lookup.i]=h,f.data("dialog",a.fn.dialog.lookup.i),g=a.fn.dialog.lookup[f.data("dialog")])}"string"==typeof c&&g[c](),d.close=function(){h.closeDialog()},d.update=function(a){h.update(a)}})},b.jQuery||(a.fn.dialog.lookup={i:0}),a.fn.dialog.defaults={type:"alert",style:"default",titleShow:!0,titleText:"提示",bodyNoScroll:!1,closeBtnShow:!1,content:"",contentScroll:!0,dialogClass:"",autoClose:0,overlayShow:!0,overlayClose:!1,buttonStyle:"side",buttonTextConfirm:"确定",buttonTextCancel:"取消",buttonClassConfirm:"",buttonClassCancel:"",buttons:[],infoIcon:"",infoText:"",position:"center",onClickConfirmBtn:function(){},onClickCancelBtn:function(){},onClickCloseBtn:function(){},onBeforeShow:function(){},onShow:function(){},onBeforeClosed:function(){},onClosed:function(){}}}(window.jQuery||window.Zepto,window,document),function(a,b,c,d){"use strict";a(c).ready(function(){var b,d,e,f,g,h;a(c).on("touchstart",function(c){var c=c.originalEvent||c,i=c.changedTouches[0];h=a("tagName"in i.target?i.target:i.target.parentNode),g=new Date,b=i.clientX,d=i.clientY,e=i.clientX,f=i.clientY}).on("touchmove",function(a){var a=a.originalEvent||a,b=a.changedTouches[0];e=b.clientX,f=b.clientY}).on("touchend",function(a){var a=a.originalEvent||a;a.changedTouches[0];new Date-g<300&&Math.abs(e-b)+Math.abs(f-d)<30&&h.trigger("tapEvent"),g=0,b=0,d=0,e=0,f=0})}),["tapEvent"].forEach(function(b){a.fn[b]=function(a){return this.on(b,a)}})}(window.jQuery||window.Zepto,window,document),function(a,b,c,d){"use strict";function e(a){try{return a.getBoundingClientRect()}catch(a){console.log("No support getBoundingClientRect",a.message)}}var f=function(){function b(b,c){var d=this;d.$element=a(b),d.settings=a.extend({},a.fn.ripple.defaults,c),d.target=null,d.positionX=0,d.positionY=0,d.init()}return b.prototype={init:function(){this.bindEvents()},bindEvents:function(){var b=this;b.$element.on(g.downEvent,function(c){var d=c.changedTouches?c.changedTouches[0]:c;b.target=a(d.target),b.positionX=d.pageX,b.positionY=d.pageY,b.creatRipple()}),a(c).on("webkitAnimationEnd MSAnimationEnd animationend","."+b.settings.className,function(){var a=this;b.removeRipple(a)})},creatRipple:function(){var b=this,c=e(b.target[0]),d=Math.max(c.width,c.height),f=b.target.offset().left,g=b.target.offset().top;b.$rippleElement=a("<"+b.settings.tagName+"></"+b.settings.tagName+">"),b.$rippleElement.addClass(b.settings.className).css({left:b.positionX-f-d/2,top:b.positionY-g-d/2,width:d,height:d}),b.target.append(b.$rippleElement)},removeRipple:function(a){a.remove()}},b}(),g=function(a){var b=a.navigator.userAgent,d=/android|adr/gi.test(b),e=/iphone|ipod|ipad/gi.test(b)&&!d,f=d||e,g="ontouchend"in c;return{downEvent:f&&g?"touchstart":"mousedown"}}(b);a.fn.ripple=function(a){var b=[];return this.each(function(c,d){b.push(new f(d,a))}),b},a.fn.ripple.defaults={tagName:"span",className:"ripple"},a(function(){return new f(a("[data-ripple]"))})}(window.jQuery||window.Zepto,window,document);